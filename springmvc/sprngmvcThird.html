<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringMVC核心技术 | 有空看看</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/dose1/assets/css/0.styles.c9546c7c.css" as="style"><link rel="preload" href="/dose1/assets/js/app.370f2ecb.js" as="script"><link rel="preload" href="/dose1/assets/js/2.579f079f.js" as="script"><link rel="preload" href="/dose1/assets/js/28.c8d6aeb7.js" as="script"><link rel="prefetch" href="/dose1/assets/js/10.15b385d2.js"><link rel="prefetch" href="/dose1/assets/js/11.7719a193.js"><link rel="prefetch" href="/dose1/assets/js/12.7a3b1235.js"><link rel="prefetch" href="/dose1/assets/js/13.bf569039.js"><link rel="prefetch" href="/dose1/assets/js/14.f04af72a.js"><link rel="prefetch" href="/dose1/assets/js/15.cae4f64f.js"><link rel="prefetch" href="/dose1/assets/js/16.28681f08.js"><link rel="prefetch" href="/dose1/assets/js/17.54584c3d.js"><link rel="prefetch" href="/dose1/assets/js/18.4b466fb7.js"><link rel="prefetch" href="/dose1/assets/js/19.882f21ee.js"><link rel="prefetch" href="/dose1/assets/js/20.6d8d7aa6.js"><link rel="prefetch" href="/dose1/assets/js/21.ed3f43c1.js"><link rel="prefetch" href="/dose1/assets/js/22.b9fd778f.js"><link rel="prefetch" href="/dose1/assets/js/23.2563d097.js"><link rel="prefetch" href="/dose1/assets/js/24.33dab2d6.js"><link rel="prefetch" href="/dose1/assets/js/25.35b2c93b.js"><link rel="prefetch" href="/dose1/assets/js/26.fa63a29b.js"><link rel="prefetch" href="/dose1/assets/js/27.a5ca9c28.js"><link rel="prefetch" href="/dose1/assets/js/29.bc350787.js"><link rel="prefetch" href="/dose1/assets/js/3.dddbab9e.js"><link rel="prefetch" href="/dose1/assets/js/4.dacb7f3f.js"><link rel="prefetch" href="/dose1/assets/js/5.516cbc1e.js"><link rel="prefetch" href="/dose1/assets/js/6.c1a5c5b5.js"><link rel="prefetch" href="/dose1/assets/js/7.eb3c1009.js"><link rel="prefetch" href="/dose1/assets/js/8.7ced4e1e.js"><link rel="prefetch" href="/dose1/assets/js/9.fb95937f.js">
    <link rel="stylesheet" href="/dose1/assets/css/0.styles.c9546c7c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dose1/" class="home-link router-link-active"><img src="/dose1/assets/img/logo.jpg" alt="有空看看" class="logo"> <span class="site-name can-hide">有空看看</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dose1/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/datarepo/mysql/mysql.html" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/dose1/foo/two.html" class="nav-link">
  备用
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/mybefore/mybase/前端基础.html" class="nav-link">
  三件套
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myjQuery/jQuery.html" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myajax/ajax.html" class="nav-link">
  AJAX
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myVue/Vue2/Vue1.html" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myVue/Vue3/Vue3.html" class="nav-link">
  Vue3
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/springpre/pre.html" class="nav-link">
  spring前言
</a></li><li class="dropdown-item"><!----> <a href="/dose1/springmvc/springmvc.html" class="nav-link">
  springMVC
</a></li><li class="dropdown-item"><!----> <a href="/dose1/SpringBoot2/SpringBootFirst.html" class="nav-link">
  springBoot2
</a></li><li class="dropdown-item"><!----> <a href="/dose1/foo/one.html" class="nav-link">
  备用
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/other/newJava.html" class="nav-link">
  java8新特性
</a></li><li class="dropdown-item"><!----> <a href="/dose1/other/HashMap.html" class="nav-link">
  hashmap
</a></li><li class="dropdown-item"><!----> <a href="https://jojo-995.gitee.io/2021/03/06/markdown-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/dose1/foo/two.html" class="nav-link">
  备用
</a></li></ul></div></div> <a href="https://github.com/jack110959/dose1" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dose1/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/datarepo/mysql/mysql.html" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/dose1/foo/two.html" class="nav-link">
  备用
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/mybefore/mybase/前端基础.html" class="nav-link">
  三件套
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myjQuery/jQuery.html" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myajax/ajax.html" class="nav-link">
  AJAX
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myVue/Vue2/Vue1.html" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/dose1/mybefore/myVue/Vue3/Vue3.html" class="nav-link">
  Vue3
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/springpre/pre.html" class="nav-link">
  spring前言
</a></li><li class="dropdown-item"><!----> <a href="/dose1/springmvc/springmvc.html" class="nav-link">
  springMVC
</a></li><li class="dropdown-item"><!----> <a href="/dose1/SpringBoot2/SpringBootFirst.html" class="nav-link">
  springBoot2
</a></li><li class="dropdown-item"><!----> <a href="/dose1/foo/one.html" class="nav-link">
  备用
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dose1/other/newJava.html" class="nav-link">
  java8新特性
</a></li><li class="dropdown-item"><!----> <a href="/dose1/other/HashMap.html" class="nav-link">
  hashmap
</a></li><li class="dropdown-item"><!----> <a href="https://jojo-995.gitee.io/2021/03/06/markdown-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/dose1/foo/two.html" class="nav-link">
  备用
</a></li></ul></div></div> <a href="https://github.com/jack110959/dose1" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Springmvc</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dose1/springmvc/springmvc.html" class="sidebar-link">SpringMvc总体</a></li><li><a href="/dose1/springmvc/springmvcfirst.html" class="sidebar-link">SpringMVC配置式开发</a></li><li><a href="/dose1/springmvc/sprngmvcSecond.html" class="sidebar-link">SpringMVC注解式开发</a></li><li><a href="/dose1/springmvc/sprngmvcThird.html" aria-current="page" class="active sidebar-link">SpringMVC核心技术</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#一-请求转发与重定向" class="sidebar-link">一，请求转发与重定向</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_1-返回modelandview时的请求转发" class="sidebar-link">1，返回ModelAndView时的请求转发</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_2-返回modelandview时的重定向" class="sidebar-link">2,返回ModelAndView时的重定向</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_3-返回string时的请求转发" class="sidebar-link">3，返回String时的请求转发</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_4-返回string时的重定向" class="sidebar-link">4，返回String时的重定向</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_5-返回void时的请求转发" class="sidebar-link">5，返回void时的请求转发</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_6-返回void时的重定向" class="sidebar-link">6，返回void时的重定向</a></li></ul></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#二-异常处理" class="sidebar-link">二，异常处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_1-异常处理器" class="sidebar-link">1，异常处理器</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_2-自定义异常处理器" class="sidebar-link">2，自定义异常处理器</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_3-异常处理注解" class="sidebar-link">3,异常处理注解</a></li></ul></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#三-类型转换器" class="sidebar-link">三，类型转换器</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#四-数据绑定问题" class="sidebar-link">四，数据绑定问题</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#五-日期格式的绑定" class="sidebar-link">五，日期格式的绑定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_1-一种格式" class="sidebar-link">1,一种格式</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_2-多种格式" class="sidebar-link">2，多种格式</a></li></ul></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#六-数据格式的验证" class="sidebar-link">六，数据格式的验证</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#七-文件上传" class="sidebar-link">七，文件上传</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_1-单个文件" class="sidebar-link">1，单个文件</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_2-多个文件" class="sidebar-link">2，多个文件</a></li><li class="sidebar-sub-header"><a href="/dose1/springmvc/sprngmvcThird.html#_3-异常处理" class="sidebar-link">3，异常处理</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="springmvc核心技术"><a href="#springmvc核心技术" class="header-anchor">#</a> SpringMVC核心技术</h1> <h2 id="一-请求转发与重定向"><a href="#一-请求转发与重定向" class="header-anchor">#</a> 一，请求转发与重定向</h2> <p>当处理器对请求处理完毕后，向其它资源进行跳转时，有两种跳转方式：请求转发与重定向。</p> <p><strong>需要注意的是转发到页面，可以直接获取request中的数据，而重定向不可以。</strong></p> <p><strong>不过重定向可以使用ModelAndView中的model或者HttpSession来携带参数。</strong></p> <p><strong>两种方式的区别就是model只能携带基本类型，而HttpSession可以携带自定义的对象类型和其他基本类型</strong></p> <p>根据所要跳转的资源类型，又可分为两类：跳转到页面与跳转到其它处理器。</p> <p>注意，对于请求转发的页面，可以是WEB-INF中页面；而重定向的页面，是不能为WEB-INF中页的。因为重定向相当于用户再次发出一次请求，而用户是不能直接访问WEB-INF中资源的。</p> <p><img src="https://raw.githubusercontent.com/jack110959/pictures/main/imgimage-20210606173856049.png" alt="image-20210606173856049"></p> <h3 id="_1-返回modelandview时的请求转发"><a href="#_1-返回modelandview时的请求转发" class="header-anchor">#</a> 1，返回ModelAndView时的请求转发</h3> <p>返回ModelAndView时的请求转发默认情况下，当处理器方法返回ModelAndView时，跳转到指定的View，使用的是请求转发。但也可显式的进行指出。此时，需在setViewName()指定的视图前添加<strong>forward:</strong>，<strong>且此时的视图不会再与视图解析器中的前辍与后辍进行拼接</strong>。即必须写出相对于项目根的路径。故此时的视图解析器不再需要前辍与后辍。请求转发到页面：请求转发到其它Controller：</p> <p>示例如下</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">/* 请求转发到其它页面 */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/helloone&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">forwardfirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;forward&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;forward:/WEB-INF/jsp/success.jsp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mav<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    <span class="token comment">/* 请求转发到其它Controller，比如上面方法 */</span>
	<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/hellotwo&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">forwardSecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;forward&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;forward:/helloone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mav<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-返回modelandview时的重定向"><a href="#_2-返回modelandview时的重定向" class="header-anchor">#</a> 2,返回ModelAndView时的重定向</h3> <p>返回ModelAndView时的重定向，需在setViewName()指定的视图前添加redirect:，且此时的视图不会再与视图解析器中的前辍与后辍进行拼接。即必须写出相对于项目根的路径。故此时的视图解析器不再需要前辍与后辍。<strong>重定向的目标资源中，将无法访问用户提交请求request中的数据。</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/cdxone&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">firstredirect</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;redirectone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;msgtwo&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;redirect:show.jsp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mav<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/cdxtwo&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">secondredirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;redirecttwo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;redirect:/cdxone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mav<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>需要注意的是在重定向时，请求参数是无法通过request的属性向下一级资源中传递的。但可以通过以下方式将请求参数向下传递。</p> <h4 id="a-通过modelandview的model携带参数"><a href="#a-通过modelandview的model携带参数" class="header-anchor">#</a> A，通过ModelAndView的Model携带参数</h4> <p>当ModelAndView中的Model存入数据后，视图解析器InternalResourceViewResolver会将map中的key与value，以请求参数的形式放到请求的URL后。</p> <p>不过需要注意以下几点：</p> <ul><li>由于视图解析器会将Map的value放入到URL后作为请求参数传递出去，所以无论什么类型的value，均会变为String。故此，<strong>放入到Model中的value，只能是基本数据类型与String</strong>，<strong>不能是自定义类型的对象数据。</strong></li> <li><strong>重定向的面页中是无法从request中读取数据的</strong>。但由于map中的key与value，以请求参数的形式放到了请求的URL后，所以，<strong>页面可以通过EL表达式中的请求参数param读取。</strong></li> <li>重定向的页面不能是/WEB-INF中的页面。</li></ul> <p>所以在页面读取为</p> <div class="language-jsp extra-class"><pre class="language-text"><code>msg=${param.msg}&lt;br/&gt;
msgtwo=${param.msgtwo}&lt;br/&gt;
</code></pre></div><h4 id="b-使用httpsession携带参数"><a href="#b-使用httpsession携带参数" class="header-anchor">#</a> B，使用HttpSession携带参数</h4> <p>与model不同的是使用HttpSession可以携带简单的数据类型，也可以携带自定义的对象类型</p> <p>携带方式用<strong>setAttribute</strong>方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/cdxthree&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">thirdredirect</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;session&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;redirect:/cdxfour&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mav<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在页面用sessionScope接收</p> <div class="language-jsp extra-class"><pre class="language-text"><code>${sessionScope.msg}&lt;br/&gt;
</code></pre></div><p>在其他Controller方法中用session的getAttribute方法接收</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/cdxfour&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">forthredirect</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mav <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> st<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;forthmsg&quot;</span><span class="token punctuation">,</span> st<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mav<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;redirect:/cdxone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mav<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

</code></pre></div><h3 id="_3-返回string时的请求转发"><a href="#_3-返回string时的请求转发" class="header-anchor">#</a> 3，返回String时的请求转发</h3> <h3 id="_4-返回string时的重定向"><a href="#_4-返回string时的重定向" class="header-anchor">#</a> 4，返回String时的重定向</h3> <h3 id="_5-返回void时的请求转发"><a href="#_5-返回void时的请求转发" class="header-anchor">#</a> 5，返回void时的请求转发</h3> <h3 id="_6-返回void时的重定向"><a href="#_6-返回void时的重定向" class="header-anchor">#</a> 6，返回void时的重定向</h3> <h2 id="二-异常处理"><a href="#二-异常处理" class="header-anchor">#</a> 二，异常处理</h2> <h3 id="_1-异常处理器"><a href="#_1-异常处理器" class="header-anchor">#</a> 1，异常处理器</h3> <p>使用场景，在服务器中发生各种异常，或许自己判断会发生哪些异常时可以使用。</p> <p><strong>SimpleMappingExceptionResolver</strong>，自带的异常处理器</p> <p>需要自己定义异常类，一般一个无参构造器加字符串形参构造器即可。在可能发生异常的地方throw对应的异常类即可。如下</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NameException</span><span class="token punctuation">(</span><span class="token string">&quot;你不是他&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre></div><p>然后就是需要springmvc配置文件中注册异常处理器</p> <div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span>
	<span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.web.servlet.handler.SimpleMappingExceptionResolver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!-- 自定义异常类，prop中的页面路径（NameeError和age）要与视图解析器对应 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exceptionMappings<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext.NameException<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>NameeError<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext.AgeException<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Age<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
     <span class="token comment">&lt;!-- 发生异常时如果没有指定异常处理器即使用下面的处理器，展示默认异常界面 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultErrorView<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dferror<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 携带异常信息ex到异常响应页面 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exceptionAttribute<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ex<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>exceptionMappings：Properties类型属性，用于指定具体的不同类型的异常所对应的异常响应页面。Key为异常类的全限定性类名，value则为响应页面路径</li> <li>defaultErrorView：指定默认的异常响应页面。若发生的异常不是exceptionMappings中指定的异常，则使用默认异常响应页面。</li> <li>exceptionAttribute：捕获到的异常对象。一般异常响应页面中使用。</li></ul> <h3 id="_2-自定义异常处理器"><a href="#_2-自定义异常处理器" class="header-anchor">#</a> 2，自定义异常处理器</h3> <p>自定义异常处理器，需要实现<strong>HandlerExceptionResolver</strong>接口，并且该类需要在SpringMVC配置文件中进行注册。</p> <p>使用SpringMVC定义好的SimpleMappingExceptionResolver异常处理器，可以实现发生指定异常后的跳转。但若要<strong>实现在捕获到指定异常时，执行一些操作的目的</strong>，它是完成不了的。此时，就需要自定义异常处理器。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyExceptionResolve</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerExceptionResolver</span> <span class="token punctuation">{</span>
    
    <span class="token comment">//当一个类实现了HandlerExceptionResolver接口后，只要有异常发生，无论什么异常，都会自动执行接口方法resolveException()。 </span>
    
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">resolveException</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handle<span class="token punctuation">,</span>
			<span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// TODO Auto-generated method stub</span>
		<span class="token class-name">ModelAndView</span> mv<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//加入异常对象</span>
		mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;ex&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//默认异常响应页面</span>
		mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;dferror&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//如果有符合该类异常的就修改响应页面</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>ex <span class="token keyword">instanceof</span> <span class="token class-name">NameException</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;姓名异常发生进行一些操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;NameeError&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>ex <span class="token keyword">instanceof</span> <span class="token class-name">AgeException</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;age异常发生进行一些操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>最后记得在springmvc的配置文件中注册该异常处理器</p> <div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ExceptionResolve.MyExceptionResolve<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_3-异常处理注解"><a href="#_3-异常处理注解" class="header-anchor">#</a> 3,异常处理注解</h3> <p><strong>一般推荐使用这种异常处理方法，需要注意的是该方法只能处理没有被内部处理的异常，比如内部自己使用try-catch处理，在外部就无法使用该注解获取到该异常，自然也就无法处理了。比如下面时间转换器的ParseException异常，在控制层就无法使用注解进行处理，当然，可以人工的抛出一个一样的异常，这样注解就可以获取到了，也就可以进行一些操作。</strong></p> <p>使用注解**@ExceptionHandler**可以将一个方法指定为异常处理方法。该注解只有一个可选属性value，为一个Class&lt;?&gt;数组，用于指定该注解的方法所要处理的异常类，即所要匹配的异常。</p> <p>而被注解的方法，其返回值可以是ModelAndView、String，或void，方法名随意，方法,参数可以是Exception及其子类对象、HttpServletRequest、HttpServletResponse等。系统会自动为这些方法参数赋值</p> <p>对于异常处理注解的用法，也可以直接将异常处理方法注解于Controller之中。不过，一般不这样使用。而是<strong>将异常处理方法专门定义在一个Controller中，让其它Controller继承该Controller即可</strong>。但是，这种用法的弊端也很明显：Java是“单继承多实现”的，这个Controller的继承将这<strong>唯一</strong>的一个<strong>继承机会</strong>使用了，使得若再有其它类需要继承，将无法直接实现。</p> <p>新建一个控制类来专门存放异常处理方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyExceptionResolveController</span> <span class="token punctuation">{</span>
   <span class="token comment">//name异常处理器</span>
	<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">NameException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">handleNameException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mv<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;ex&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;NameeError&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//age异常处理器</span>
	<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">AgeException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">handleAgeException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mv<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;ex&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//其他异常处理器</span>
	<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">handleOtherException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mv<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;ex&quot;</span><span class="token punctuation">,</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;dferror&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样其他的控制层如果想使用这些异常方法只需要继承该控制类即可。</p> <h2 id="三-类型转换器"><a href="#三-类型转换器" class="header-anchor">#</a> 三，类型转换器</h2> <p>在前面的程序中，表单提交的无论是int还是double类型的请求参数，用于处理该请求的处理器方法的形参，均可直接接收到相应类型的相应数据，而非接收到String再手工转换。那是因为在SpringMVC框架中，有默认的类型转换器。这些默认的类型转换器，可以将String类型的数据，自动转换为相应类型的数据。</p> <p>所有如果你在未来的开发如果遇到了一些特殊类型的数据，就可以自己定义一个类型转换器来自动接收。</p> <p>那么，该如何定义呢，主要有两步。</p> <p>第一步，在src目录下，定义一个实现了Converter&lt;S, T&gt;接口的实现类，S一般表示字符串，T可以表示想转换的任意类型数据，然后在接口的抽象方法convert(String str）自定义你所需要的类型转换。</p> <p>第二步，就是在springmvc配置文件中，注册你的类型转换器。</p> <p>这里简单就以最常见的日期类型的转换器为例。</p> <p>默认情况下，日期只有2021/7/21格式的转换器，所以如果你想使用其他的日期格式就需要自己定义了。</p> <p>第一步，定义时间类型转换器</p> <p>getSimpleDateFormat方法中，使用正则表达式来对前端的时间格式进行判断后返回对应格式的SimpleDateFormat的对象，从而保证能够正常的进行类型转换，并且支持多种时间格式的绑定。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDateConvent</span> <span class="token keyword">implements</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Date</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// TODO Auto-generated method stub</span>
		<span class="token class-name">SimpleDateFormat</span> sdf<span class="token operator">=</span><span class="token function">getSimpleDateFormat</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> sdf<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// TODO Auto-generated catch block</span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		 <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleDateFormat</span> <span class="token function">getSimpleDateFormat</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// TODO Auto-generated method stub</span>
		<span class="token class-name">SimpleDateFormat</span> sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;^\\d{4}-\\d{2}-\\d{2}$&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;^\\d{4}/\\d{2}/\\d{2}$&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy/MM/dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;^\\d{4}\\d{2}\\d{2}$&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyMMdd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeMismatchException</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> sdf<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>第二步，注册类型转换器</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 注册类型转换器 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myDateConvent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.util.MyDateConvent<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token comment">&lt;!-- 注册转换服务对象 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>conversionService<span class="token punctuation">&quot;</span></span>
		<span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.context.support.ConversionServiceFactoryBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>converters<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!--如果有多个类型转换器可以在这里添加 --&gt;</span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myDateConvent<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span>
		<span class="token attr-name">conversion-service</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>conversionService<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h2 id="四-数据绑定问题"><a href="#四-数据绑定问题" class="header-anchor">#</a> 四，数据绑定问题</h2> <p><strong>以下解决的是对在前端name属性跟后端控制层接收属性名一致的条件下，发生的类型转换异常的处理。</strong></p> <p>在控制层数据自动绑定时，可能会出现用户输入的是字符串类型，接收的时候是用int类型接收的。</p> <p>或者时间格式与常规的几种格式都不匹配等情况，所以我们需要使用一个异常注解来解决该问题，并能够将用户输入的数据进行回显，并且可以通过异常信息中含有的用户输入信息来判断是哪个输入异常的问题，从而返回对应的异常信息。代码如下</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">TypeMismatchException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ModelAndView</span> mv<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> date<span class="token operator">=</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> name<span class="token operator">=</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> message<span class="token operator">=</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> message<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;dateError&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;时间格式错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> message<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;nameError&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;名字格式错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;TestDate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="五-日期格式的绑定"><a href="#五-日期格式的绑定" class="header-anchor">#</a> 五，日期格式的绑定</h2> <h3 id="_1-一种格式"><a href="#_1-一种格式" class="header-anchor">#</a> 1,一种格式</h3> <p>如果系统中前端传来的时间字符串格式都是统一的，可以采用下面这种更为方便的方法。</p> <p>在控制层中加人下列方法，在进行数据绑定前，会先将&quot;yyyy-MM-dd&quot;格式的字符串转换为date类型</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@InitBinder</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">InitBinder</span><span class="token punctuation">(</span><span class="token class-name">WebDataBinder</span> binder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">DateFormat</span>  df<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binder<span class="token punctuation">.</span><span class="token function">registerCustomEditor</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CustomDateEditor</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-多种格式"><a href="#_2-多种格式" class="header-anchor">#</a> 2，多种格式</h3> <p>如果想接收多种格式的时间字符串，那么框架自带的Editor已经不能满足我们的需求了，我们需要自己重新定义一个Editor来使用。</p> <p>如果需要接收多种格式的时间字符串，又不想在配置文件添加，可以采用如下方法</p> <p>先在src自己定义一个Editor来处理自己想接收的各种格式</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDateEditor</span> <span class="token keyword">extends</span> <span class="token class-name">PropertiesEditor</span><span class="token punctuation">{</span>
	
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAsText</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalArgumentException</span> <span class="token punctuation">{</span>
		<span class="token comment">// TODO Auto-generated method stub</span>
		<span class="token class-name">SimpleDateFormat</span> sdf<span class="token operator">=</span><span class="token function">getSimpleDateFormat</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token class-name">Date</span> date <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setValue</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// TODO Auto-generated catch block</span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
        
	<span class="token keyword">private</span> <span class="token class-name">SimpleDateFormat</span> <span class="token function">getSimpleDateFormat</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// TODO Auto-generated method stub</span>
		<span class="token class-name">SimpleDateFormat</span> sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;开始判断&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;^\\d{4}-\\d{2}-\\d{2}$&quot;</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;判断后yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;^\\d{4}/\\d{2}/\\d{2}$&quot;</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;判断后yyyy/MM/dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy/MM/dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;^\\d{4}\\d{2}\\d{2}$&quot;</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;判断后yyyyMMdd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sdf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyMMdd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeMismatchException</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> sdf<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
</code></pre></div><p>最后就使用我们自己的编写的Editor</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@InitBinder</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">InitBinder</span><span class="token punctuation">(</span><span class="token class-name">WebDataBinder</span> binder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">DateFormat</span>  df<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binder<span class="token punctuation">.</span><span class="token function">registerCustomEditor</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MyDateEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="六-数据格式的验证"><a href="#六-数据格式的验证" class="header-anchor">#</a> 六，数据格式的验证</h2> <p>当前端发送的数据类型跟控制层接收的类型不一致时，我们在第四点就可以解决了。但如果我们的系统安全性较高，我们还必须要求在符合数据绑定类型的前提下，还要符合某种自定义的格式，那么该如何解决了。</p> <p>比如前端传的手机号，我们可以用正则表达式来定义他的格式。除此之外，我们也可以限制Intege类型的大小，或者字符的长度范围等。</p> <p>下面就是使用的方法</p> <ul><li>第一步，导入对应的jar包，需要注意的是在Java9及以上版本需要添加额外的jar包。</li> <li>第二步，在springmvc配置文件中注册验证器。</li> <li>第三步，在对应pojo类对应的属性上加上相应的注解，message属性可以自己编写报错信息。</li> <li>第四步，在控制层方法形参中，给用来接收的pojo类对象加上注解@Validated。并多加BindingResult对象来返回错误信息。调用BindingResult的getFieldError（）可以获取对应的属性的报错信息。</li></ul> <p>具体的使用如下</p> <p><strong>第一步，导入jar</strong></p> <p>java9之前导入3个，java9及之后，导入3+4个。</p> <p><strong>第二步，注册验证器</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 数据验证的配置 --&gt;</span>
	<span class="token comment">&lt;!-- 全局数据校验 --&gt;</span>
	<span class="token comment">&lt;!-- 数据验证 Validator bean --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>validator<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.validation.beanvalidation.LocalValidatorFactoryBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 校验器，使用hibernate校验器 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>providerClass<span class="token punctuation">&quot;</span></span>
			<span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.hibernate.validator.HibernateValidator<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span> <span class="token attr-name">validator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>validator<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><strong>第三步，在pojo类属性上加上格式要求的注解</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;姓名不能为空&quot;</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>max <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;姓名必须{min}到{max}个字符&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;成绩不能低于{value}&quot;</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Max</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;成绩不能高于{value}&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> score<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp <span class="token operator">=</span> <span class="token string">&quot;^1[34578]\\d{9}$&quot;</span><span class="token punctuation">,</span>message <span class="token operator">=</span> <span class="token string">&quot;手机号格式不对&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span>
	<span class="token comment">//get,set,toString</span>
</code></pre></div><p><strong>第四步，在控制层接收，并返回错误信息。</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;check.do&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span> <span class="token class-name">Student</span> student<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> br<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token class-name">ModelAndView</span> mv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObjectError</span><span class="token punctuation">&gt;</span></span> allErrors <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>allErrors<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">FieldError</span> nameError <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">FieldError</span> scoreError <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token string">&quot;score&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">FieldError</span> phoneError <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token string">&quot;phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
			<span class="token keyword">if</span> <span class="token punctuation">(</span>nameError <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;nameError&quot;</span><span class="token punctuation">,</span> nameError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>scoreError <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;scoreError&quot;</span><span class="token punctuation">,</span> scoreError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>phoneError <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				mv<span class="token punctuation">.</span><span class="token function">addObject</span><span class="token punctuation">(</span><span class="token string">&quot;phoneError&quot;</span><span class="token punctuation">,</span> phoneError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		mv<span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> mv<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>其他的一些注解</strong></p> <ol><li>@AssertFalse验证注解的元素值是false</li> <li>@AssertTrue验证注解的元素值是true</li> <li>@DecimalMax（value=x）验证注解的元素值小于等于指定的十进制value值</li> <li>@DecimalMin（value=x）验证注解的元素值大于等于指定的十进制value值</li> <li>@Digits(integer=整数位数, fraction=小数位数)验证注解的元素值的整数位数和小数位数上限</li> <li>@Future验证注解的元素值（日期类型）比当前时间晚</li> <li>@Max（value=x）验证注解的元素值小于等于指定的value值</li> <li>@Min（value=x）验证注解的元素值大于等于指定的value值</li> <li>@NotNull验证注解的元素值丌是null</li> <li>@Null验证注解的元素值是null</li> <li>@Past验证注解的元素值（日期类型）比当前时间早</li> <li>@Pattern(regex=正则表达式)验证注解的元素值不指定的正则表达式匹配</li> <li>@Size(min=最小值, max=最大值)验证注解的元素值的在min和max（包含）指定区间之内，如字符长度、集合大小</li> <li>@Valid验证关联的对象，如账户对象里有一个订单对象，指定验证订单对象</li> <li>@NotEmpty验证注解的元素值丌为null且丌为空（字符串长度丌为0、集合大小丌为0）</li> <li>@Range(min=最小值, max=最大值)验证注解的元素值在最小值和最大值之间</li> <li>@NotBlank验证注解的元素值不为空（不为null、去除首位空格后长度为0），不同于@NotEmpty，@NotBlank只应用于字符串且在比较时会去除字符串的空格</li> <li>@Length(min=下限, max=上限)验证注解的元素值长度在min和max区间内</li> <li>@Email验证注解的元素值是Email，也可以通过正则表达式和flag指定自定义的email格式</li></ol> <h2 id="七-文件上传"><a href="#七-文件上传" class="header-anchor">#</a> 七，文件上传</h2> <p>这里主要说的在控制层如何接收前端提交的文件。</p> <p>第一步，导入两个jar包</p> <p>第二步，在springmvc配置文件添加配置</p> <p>第三步，选择存放的路径</p> <p>第四步，在控制层接收</p> <p>第五步，在前端页面编写form表单提交文件</p> <p>简单举例如下</p> <h3 id="_1-单个文件"><a href="#_1-单个文件" class="header-anchor">#</a> 1，单个文件</h3> <p><strong>第一步，导入两个jar包</strong></p> <p>需要导入的jar包为</p> <ul><li>commons-io-2.11.0.jar</li> <li>commons-fileupload-1.4.jar</li></ul> <p><strong>第二步，在springmvc配置文件添加配置</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- SpringMVC文件上传 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipartResolver<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.web.multipart.commons.CommonsMultipartResolver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--defaultEncoding：请求的编码格式必须和用户JSP的编码一致，以便正确读取表单中的内容。 
            uploadTempDir:文件上传过程中的临时目录，上传完成后，临时文件会自动删除 
            maxUploadSize:设置文件上传大小上限（单位为字节） --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultEncoding<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>maxUploadSize<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>102400000<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- uploadTempDir可以不做设置，有默认的路径，上传完毕会临时文件会自动被清理掉 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>uploadTempDir<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>upload/temp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
 <span class="token comment">&lt;!--最后记得添加驱动 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>1.defaultEncoding：表示用来解析request请求的默认编码格式，当没有指定的时候根据Servlet规范会使用默认值 ISO-8859-1 。当request自己指明了它的编码格式的时候就会忽略这里指定的defaultEncoding。</p> <p>2.uploadTempDir：设置上传文件时的临时目录，默认是Servlet容器的临时目录。</p> <p>3.maxUploadSize：设置允许上传的最大文件大小，以字节为单位计算。当设为-1时表示无限制，默认是-1。</p> <p>4.maxInMemorySize：设置在文件上传时允许写到内存中的最大值，以字节为单位计算，默认是10240。</p> <p><strong>第三步，选择存放的路径</strong></p> <p>在项目的WebContent或src目录下手动创建一个文件夹来存放。</p> <p><strong>第四步，在控制层接收</strong></p> <p>用MultipartFile类来接收文件</p> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;fileup.do&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">file</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> img<span class="token punctuation">,</span> <span class="token class-name">HttpSession</span> session<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

		<span class="token comment">// String path=&quot;D:\\javaEEwplace\\XueXiShiYong2\\src\\image&quot;;</span>
		<span class="token comment">//需要注意即使没有上传文件，img也不为空，可以用getsize()来判断，也可以用isEmpty()判断</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 获取文件的绝对路径(到项目名)</span>
			<span class="token class-name">String</span> path <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">&quot;/image&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> filename <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 这里可以过滤掉不符合后缀的文件</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>filename<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;jpg&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> filename<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
				img<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;成功了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span>
</code></pre></div><p>下面为一种更完善的写法，仅供参考</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;file.do&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> img<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
		<span class="token comment">// 获取文件的绝对路径</span>
		<span class="token class-name">String</span> path <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">&quot;/head&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 获取上传文件的名字</span>
		<span class="token class-name">String</span> filename <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 截取上传文件后缀名</span>
		<span class="token class-name">String</span> type <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 未避免上传文件名重复，覆盖文件将增加区别</span>
		<span class="token class-name">String</span> finallyfilename <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> type<span class="token punctuation">;</span>
		<span class="token class-name">String</span> defile <span class="token operator">=</span> path <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separatorChar <span class="token operator">+</span> finallyfilename<span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>defile<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>defile<span class="token punctuation">)</span><span class="token punctuation">;</span>
		img<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 将文件保存到指定位置</span>

		<span class="token keyword">return</span> <span class="token string">&quot;redirect:toList.do&quot;</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
</code></pre></div><p><strong>第五步，在前端页面编写form表单提交文件</strong></p> <p>提交方法为post方法，还要加多属性enctype=&quot;multipart/form-data&quot;</p> <div class="language-jsp extra-class"><pre class="language-text"><code>&lt;form action=&quot;${pageContext.request.contextPath}/fileup.do&quot;
		method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
		照片：&lt;input type=&quot;file&quot; value=&quot;选择文件&quot; name=&quot;img&quot;&gt;&lt;br&gt;
		&lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;
	&lt;/form&gt;
</code></pre></div><h3 id="_2-多个文件"><a href="#_2-多个文件" class="header-anchor">#</a> 2，多个文件</h3> <p>基本步骤都是一样</p> <p>第一步，导入两个jar包</p> <p>第二步，在springmvc配置文件添加配置</p> <p>第三步，选择存放的路径</p> <p>第四步，在控制层接收</p> <p>第五步，在前端页面编写form表单提交文件</p> <p>这里的前三步与一个文件的操作是一样，这里就不重复编写了。</p> <p><strong>第四步，在控制层接收</strong></p> <p>需要注意的要添加@RequestParam注解，不然每个文件都会自己生成一个数组，这里用的当前时间与以前一个固定时间的差值加文件后缀名为存放文件的文件名。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;file.do&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;imgs&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imgs<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
		<span class="token comment">// 获取文件的绝对路径</span>
		<span class="token class-name">String</span> path <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">&quot;/image&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> img <span class="token operator">:</span> imgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// 获取上传文件的名字</span>
				<span class="token class-name">String</span> filename <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">// 截取上传文件后缀名</span>
				<span class="token class-name">String</span> type <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">// 未避免上传文件名重复，覆盖文件将增加区别</span>
				<span class="token class-name">String</span> finallyfilename <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> type<span class="token punctuation">;</span>
				<span class="token class-name">String</span> defile <span class="token operator">=</span> path <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separatorChar <span class="token operator">+</span> finallyfilename<span class="token punctuation">;</span>
				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>defile<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>defile<span class="token punctuation">)</span><span class="token punctuation">;</span>
				img<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 将文件保存到指定位置</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token string">&quot;redirect:/index.jsp&quot;</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>

</code></pre></div><h3 id="_3-异常处理"><a href="#_3-异常处理" class="header-anchor">#</a> 3，异常处理</h3> <p>当上传文件难免会发生异常，比如文件超过设置的最大值，文件有些没选择到等问题。</p> <p>这里也只是提供一种比较简单的处理方法。</p> <p>在springmvc配置文件下添加异常处理</p> <div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.web.servlet.handler.SimpleMappingExceptionResolver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultErrorView<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/dferror<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/vuejs/vuepress/edit/master/docs/springmvc/sprngmvcThird.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/dose1/assets/js/app.370f2ecb.js" defer></script><script src="/dose1/assets/js/2.579f079f.js" defer></script><script src="/dose1/assets/js/28.c8d6aeb7.js" defer></script>
  </body>
</html>
